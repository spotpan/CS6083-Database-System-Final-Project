CREATE TABLE Usr(
uname VARCHAR(45) PRIMARY KEY NOT NULL, 
uloginname VARCHAR(45) UNIQUE NOT NULL,
upassowrd VARCHAR(25) NOT NULL);

CREATE TABLE Usrinfo(
uname VARCHAR(45) REFERENCES Usr(uname) NOT NULL,
uemail VARCHAR(45) UNIQUE NOT NULL,
uhometown VARCHAR(45),
uinterests VARCHAR(45),
ucreditcar BIGINT);

CREATE TABLE Project(
pid BIGINT PRIMARY KEY NOT NULL,
uname VARCHAR(45) REFERENCES Usr(uname) NOT NULL,
pname VARCHAR(45) NOT NULL,
pdescrption VARCHAR(500),
status BOOLEAN NOT NULL,
tags VARCHAR(200) NOT NULL,
plannedtime TIMESTAMP NOT NULL);

CREATE TABLE Projectattachment(
pid BIGINT REFERENCES Project(pid) NOT NULL,
blob BYTEA NOT NULL);

CREATE TABLE Pledge(
pid BIGINT REFERENCES Project(pid) NOT NULL,
uname VARCHAR(45) REFERENCES Usr(uname) NOT NULL,
amount INT NOT NULL,
date TIMESTAMP NOT NULL);

CREATE TABLE Charge(
pid BIGINT REFERENCES Project(pid) NOT NULL,
uname VARCHAR(45) REFERENCES Usr(uname) NOT NULL,
totalamount INT NOT NULL,
date TIMESTAMP NOT NULL);

CREATE TABLE Usrlikeproject(
pid BIGINT REFERENCES Project(pid) NOT NULL,
uname VARCHAR(45) REFERENCES Usr(uname) NOT NULL);

CREATE TABLE Follow(
uname VARCHAR(45) REFERENCES Usr(uname) NOT NULL,
following VARCHAR(45) REFERENCES Usr(uname) NOT NULL);

CREATE TABLE Comment(
pid BIGINT REFERENCES Project(pid) NOT NULL,
uname VARCHAR(45) REFERENCES Usr(uname) NOT NULL,
date TIMESTAMP NOT NULL,
content VARCHAR(500) NOT NULL);

CREATE TABLE Request(
pid BIGINT REFERENCES Project(pid) NOT NULL,
uname VARCHAR(45) REFERENCES Usr(uname) NOT NULL,
min INT NOT NULL,
max INT NOT NULL,
endtime TIMESTAMP NOT NULL);

CREATE TABLE Rate(
pid BIGINT REFERENCES Project(pid) NOT NULL,
uname VARCHAR(45) REFERENCES Usr(uname) NOT NULL,
ratenumber INT NOT NULL,
CHECK (ratenumber BETWEEN 1 AND 10))
